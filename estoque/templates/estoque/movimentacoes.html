<h1>Movimentações de Estoque</h1>
<form method="get" action="">
  Usuário: <input type="text" name="usuario" value="{{ request.GET.usuario }}">
  Produto: <input type="text" name="produto" value="{{ request.GET.produto }}">
  Tipo:
  <select name="tipo">
    <option value="">Todos</option>
    <option value="entrada" {% if request.GET.tipo == 'entrada' %}selected{% endif %}>Entrada</option>
    <option value="saida" {% if request.GET.tipo == 'saida' %}selected{% endif %}>Saída</option>
  </select>
  Data Início: <input type="date" name="data_inicio" value="{{ request.GET.data_inicio }}">
  Data Fim: <input type="date" name="data_fim" value="{{ request.GET.data_fim }}">
  <button type="submit">Filtrar</button>
  
</form>
<table border="1" cellpadding="5">
  <tr>
    <th>Data</th><th>Usuário</th><th>Produto</th><th>Tipo</th><th>Quantidade</th><th>Observação</th>
  </tr>
  {% for mov in movimentacoes %}
  <tr>
    <td>{{ mov.data|date:"d/m/Y H:i" }}</td>
    <td>{{ mov.usuario.username }}</td>
    <td>{{ mov.produto.nome }}</td>
    <td>{{ mov.get_tipo_display }}</td>
    <td>{{ mov.quantidade }}</td>
    <td>{{ mov.observacao }}</td>
  </tr>
  {% empty %}
  <tr><td colspan="6">Nenhuma movimentação</td></tr>
  {% endfor %}

</table>
<a href="{% url 'exportar_movimentacoes' %}?{{ request.GET.urlencode }}">Exportar CSV</a>
